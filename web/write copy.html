<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Forcer écriture dans DB8 de l'automate</title>
  <link rel="stylesheet" href="styles.css">
  <script>
    function forcerEcriture() {
      const texte = document.getElementById("inputTexte").value;
      const caracteres = texte.split('');
      
      // Création d'un tableau de 82 éléments
      const tableauEcriture = [];
      for (let i = 0; i < 82; i++) {
        tableauEcriture[i] = (i < caracteres.length) ? caracteres[i].charCodeAt(0) : 32;
      }
      
      // Mise à jour des champs cachés
      for (let i = 0; i < 82; i++) {
        // On suppose que chaque champ caché a pour id "var0", "var1", etc.
        document.getElementById("var" + i).value = tableauEcriture[i];
      }
      
      // Affichage pour vérification
      document.getElementById("resultat").textContent =
        "Les valeurs forcées dans DB8 : " + tableauEcriture.join(', ');
      
      // Soumettre le formulaire pour envoyer les valeurs à la CPU
      document.getElementById("writeForm").submit();
    }
  </script>
</head>
<body>
  <div class="container">
    <h1>Forcer écriture dans DB8 de l'automate</h1>
    <p>Entrez une suite de caractères (espaces compris) :</p>
    <textarea id="inputTexte" rows="4" cols="50" placeholder="Tapez votre texte ici"></textarea>
    <br>
    <button type="button" onclick="forcerEcriture()">Envoyer et forcer écriture</button>
    <p id="resultat"></p>
    <button type="button" onclick="window.location.href='index.html'">Lire les données</button>
    
    <!-- Formulaire pour envoyer les données -->
    <form id="writeForm" method="post" action="/awp/appl/x.html">
      <input type="hidden" id="var0" name="\"IdentData2\".writeData[0]">
      <input type="hidden" id="var1" name="\"IdentData2\".writeData[1]">
      <input type="hidden" id="var2" name="\"IdentData2\".writeData[2]">
      <input type="hidden" id="var3" name="\"IdentData2\".writeData[3]">
      <input type="hidden" id="var4" name="\"IdentData2\".writeData[4]">
      <input type="hidden" id="var5" name="\"IdentData2\".writeData[5]">
      <input type="hidden" id="var6" name="\"IdentData2\".writeData[6]">
      <input type="hidden" id="var7" name="\"IdentData2\".writeData[7]">
      <input type="hidden" id="var8" name="\"IdentData2\".writeData[8]">
      <input type="hidden" id="var9" name="\"IdentData2\".writeData[9]">
      <input type="hidden" id="var10" name="\"IdentData2\".writeData[10]">
      <input type="hidden" id="var11" name="\"IdentData2\".writeData[11]">
      <input type="hidden" id="var12" name="\"IdentData2\".writeData[12]">
      <input type="hidden" id="var13" name="\"IdentData2\".writeData[13]">
      <input type="hidden" id="var14" name="\"IdentData2\".writeData[14]">
      <input type="hidden" id="var15" name="\"IdentData2\".writeData[15]">
      <input type="hidden" id="var16" name="\"IdentData2\".writeData[16]">
      <input type="hidden" id="var17" name="\"IdentData2\".writeData[17]">
      <input type="hidden" id="var18" name="\"IdentData2\".writeData[18]">
      <input type="hidden" id="var19" name="\"IdentData2\".writeData[19]">
      <input type="hidden" id="var20" name="\"IdentData2\".writeData[20]">
      <input type="hidden" id="var21" name="\"IdentData2\".writeData[21]">
      <input type="hidden" id="var22" name="\"IdentData2\".writeData[22]">
      <input type="hidden" id="var23" name="\"IdentData2\".writeData[23]">
      <input type="hidden" id="var24" name="\"IdentData2\".writeData[24]">
      <input type="hidden" id="var25" name="\"IdentData2\".writeData[25]">
      <input type="hidden" id="var26" name="\"IdentData2\".writeData[26]">
      <input type="hidden" id="var27" name="\"IdentData2\".writeData[27]">
      <input type="hidden" id="var28" name="\"IdentData2\".writeData[28]">
      <input type="hidden" id="var29" name="\"IdentData2\".writeData[29]">
      <input type="hidden" id="var30" name="\"IdentData2\".writeData[30]">
      <input type="hidden" id="var31" name="\"IdentData2\".writeData[31]">
      <input type="hidden" id="var32" name="\"IdentData2\".writeData[32]">
      <input type="hidden" id="var33" name="\"IdentData2\".writeData[33]">
      <input type="hidden" id="var34" name="\"IdentData2\".writeData[34]">
      <input type="hidden" id="var35" name="\"IdentData2\".writeData[35]">
      <input type="hidden" id="var36" name="\"IdentData2\".writeData[36]">
      <input type="hidden" id="var37" name="\"IdentData2\".writeData[37]">
      <input type="hidden" id="var38" name="\"IdentData2\".writeData[38]">
      <input type="hidden" id="var39" name="\"IdentData2\".writeData[39]">
      <input type="hidden" id="var40" name="\"IdentData2\".writeData[40]">
      <input type="hidden" id="var41" name="\"IdentData2\".writeData[41]">
      <input type="hidden" id="var42" name="\"IdentData2\".writeData[42]">
      <input type="hidden" id="var43" name="\"IdentData2\".writeData[43]">
      <input type="hidden" id="var44" name="\"IdentData2\".writeData[44]">
      <input type="hidden" id="var45" name="\"IdentData2\".writeData[45]">
      <input type="hidden" id="var46" name="\"IdentData2\".writeData[46]">
      <input type="hidden" id="var47" name="\"IdentData2\".writeData[47]">
      <input type="hidden" id="var48" name="\"IdentData2\".writeData[48]">
      <input type="hidden" id="var49" name="\"IdentData2\".writeData[49]">
      <input type="hidden" id="var50" name="\"IdentData2\".writeData[50]">
      <input type="hidden" id="var51" name="\"IdentData2\".writeData[51]">
      <input type="hidden" id="var52" name="\"IdentData2\".writeData[52]">
      <input type="hidden" id="var53" name="\"IdentData2\".writeData[53]">
      <input type="hidden" id="var54" name="\"IdentData2\".writeData[54]">
      <input type="hidden" id="var55" name="\"IdentData2\".writeData[55]">
      <input type="hidden" id="var56" name="\"IdentData2\".writeData[56]">
      <input type="hidden" id="var57" name="\"IdentData2\".writeData[57]">
      <input type="hidden" id="var58" name="\"IdentData2\".writeData[58]">
      <input type="hidden" id="var59" name="\"IdentData2\".writeData[59]">
      <input type="hidden" id="var60" name="\"IdentData2\".writeData[60]">
      <input type="hidden" id="var61" name="\"IdentData2\".writeData[61]">
      <input type="hidden" id="var62" name="\"IdentData2\".writeData[62]">
      <input type="hidden" id="var63" name="\"IdentData2\".writeData[63]">
      <input type="hidden" id="var64" name="\"IdentData2\".writeData[64]">
      <input type="hidden" id="var65" name="\"IdentData2\".writeData[65]">
      <input type="hidden" id="var66" name="\"IdentData2\".writeData[66]">
      <input type="hidden" id="var67" name="\"IdentData2\".writeData[67]">
      <input type="hidden" id="var68" name="\"IdentData2\".writeData[68]">
      <input type="hidden" id="var69" name="\"IdentData2\".writeData[69]">
      <input type="hidden" id="var70" name="\"IdentData2\".writeData[70]">
      <input type="hidden" id="var71" name="\"IdentData2\".writeData[71]">
      <input type="hidden" id="var72" name="\"IdentData2\".writeData[72]">
      <input type="hidden" id="var73" name="\"IdentData2\".writeData[73]">
      <input type="hidden" id="var74" name="\"IdentData2\".writeData[74]">
      <input type="hidden" id="var75" name="\"IdentData2\".writeData[75]">
      <input type="hidden" id="var76" name="\"IdentData2\".writeData[76]">
      <input type="hidden" id="var77" name="\"IdentData2\".writeData[77]">
      <input type="hidden" id="var78" name="\"IdentData2\".writeData[78]">
      <input type="hidden" id="var79" name="\"IdentData2\".writeData[79]">
      <input type="hidden" id="var80" name="\"IdentData2\".writeData[80]">
      <input type="hidden" id="var81" name="\"IdentData2\".writeData[81]">
      
      
      <!-- Déclarations AWP pour les variables d'écriture dans DB8 (correction de la syntaxe) -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[0]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[1]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[2]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[3]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[4]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[5]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[6]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[7]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[8]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[9]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[10]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[11]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[12]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[13]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[14]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[15]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[16]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[17]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[18]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[19]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[20]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[21]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[22]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[23]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[24]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[25]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[26]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[27]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[28]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[29]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[30]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[31]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[32]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[33]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[34]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[35]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[36]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[37]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[38]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[39]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[40]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[41]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[42]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[43]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[44]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[45]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[46]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[47]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[48]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[49]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[50]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[51]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[52]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[53]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[54]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[55]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[56]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[57]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[58]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[59]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[60]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[61]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[62]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[63]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[64]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[65]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[66]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[67]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[68]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[69]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[70]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[71]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[72]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[73]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[74]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[75]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[76]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[77]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[78]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[79]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[80]' -->
      <!-- AWP_In_Variable Name='"IdentData2".writeData[81]' -->

    </form>
  </div>
</body>
</html>
